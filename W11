{"cells":[{"cell_type":"code","source":["from keras.datasets import fashion_mnist\n","from keras.datasets.fashion_mnist import load_data\n","from keras.utils import to_categorical\n","from keras.models import Sequential\n","from keras.layers import Dense, Dropout, Flatten, Conv2D, MaxPool2D, Normalization, LeakyReLU\n","from keras.optimizers import Adam\n","from keras.losses import categorical_crossentropy"],"metadata":{"id":"uEMJvALpfmEw","executionInfo":{"status":"ok","timestamp":1681952896323,"user_tz":-420,"elapsed":4132,"user":{"displayName":"Phúc Nguyễn Ngọc","userId":"08603269780001331701"}}},"execution_count":1,"outputs":[]},{"cell_type":"code","source":["(x_train,y_train),(x_test,y_test)=fashion_mnist.load_data()\n","x_train=x_train.reshape(60000,28,28,1)\n","x_train=x_train.astype(\"float32\")/255\n","x_test=x_test.reshape(10000,28,28,1)\n","x_test=x_test.astype(\"float32\")/255\n","y_train=to_categorical(y_train,10)\n","y_test=to_categorical(y_test,10)"],"metadata":{"id":"nqnm1nEWgEsA","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1681952905416,"user_tz":-420,"elapsed":5963,"user":{"displayName":"Phúc Nguyễn Ngọc","userId":"08603269780001331701"}},"outputId":"9e16d6ab-70e7-4722-ca63-412d71fc5a52"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-labels-idx1-ubyte.gz\n","29515/29515 [==============================] - 0s 1us/step\n","Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-images-idx3-ubyte.gz\n","26421880/26421880 [==============================] - 2s 0us/step\n","Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-labels-idx1-ubyte.gz\n","5148/5148 [==============================] - 0s 0us/step\n","Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-images-idx3-ubyte.gz\n","4422102/4422102 [==============================] - 1s 0us/step\n"]}]},{"cell_type":"code","source":["model=Sequential()\n","model.add(Conv2D(32,kernel_size=(3,3),activation='linear',input_shape=(28,28,1),padding='same'))\n","model.add(LeakyReLU(alpha=0.1))\n","model.add(MaxPool2D((2,2),padding='same'))\n","\n","model.add(Conv2D(64,kernel_size=(3,3),activation='linear',padding='same'))\n","model.add(LeakyReLU(alpha=0.1))\n","model.add(MaxPool2D((2,2),padding='same'))\n","\n","model.add(Conv2D(128,kernel_size=(3,3),activation='linear',padding='same'))\n","model.add(LeakyReLU(alpha=0.1))\n","model.add(MaxPool2D((2,2),padding='same'))\n","\n","model.add(Flatten())\n","model.add(Dense(128,activation='linear'))\n","model.add(LeakyReLU(alpha=0.1))\n","model.add(Dense(10,activation='softmax'))\n","\n","model.compile(loss=categorical_crossentropy,optimizer=Adam(),metrics=['accuracy'])\n","model.summary()\n","train= model.fit(x_train, y_train, batch_size=64, epochs=20, verbose=1)"],"metadata":{"id":"mtrnDylei6al","executionInfo":{"status":"ok","timestamp":1681953056055,"user_tz":-420,"elapsed":147179,"user":{"displayName":"Phúc Nguyễn Ngọc","userId":"08603269780001331701"}},"outputId":"6e64cb79-7b5e-425d-8fbc-dccece240382","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"sequential\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," conv2d (Conv2D)             (None, 28, 28, 32)        320       \n","                                                                 \n"," leaky_re_lu (LeakyReLU)     (None, 28, 28, 32)        0         \n","                                                                 \n"," max_pooling2d (MaxPooling2D  (None, 14, 14, 32)       0         \n"," )                                                               \n","                                                                 \n"," conv2d_1 (Conv2D)           (None, 14, 14, 64)        18496     \n","                                                                 \n"," leaky_re_lu_1 (LeakyReLU)   (None, 14, 14, 64)        0         \n","                                                                 \n"," max_pooling2d_1 (MaxPooling  (None, 7, 7, 64)         0         \n"," 2D)                                                             \n","                                                                 \n"," conv2d_2 (Conv2D)           (None, 7, 7, 128)         73856     \n","                                                                 \n"," leaky_re_lu_2 (LeakyReLU)   (None, 7, 7, 128)         0         \n","                                                                 \n"," max_pooling2d_2 (MaxPooling  (None, 4, 4, 128)        0         \n"," 2D)                                                             \n","                                                                 \n"," flatten (Flatten)           (None, 2048)              0         \n","                                                                 \n"," dense (Dense)               (None, 128)               262272    \n","                                                                 \n"," leaky_re_lu_3 (LeakyReLU)   (None, 128)               0         \n","                                                                 \n"," dense_1 (Dense)             (None, 10)                1290      \n","                                                                 \n","=================================================================\n","Total params: 356,234\n","Trainable params: 356,234\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","938/938 [==============================] - 14s 5ms/step - loss: 0.4415 - accuracy: 0.8387\n","Epoch 2/20\n","938/938 [==============================] - 5s 5ms/step - loss: 0.2735 - accuracy: 0.8997\n","Epoch 3/20\n","938/938 [==============================] - 6s 6ms/step - loss: 0.2266 - accuracy: 0.9171\n","Epoch 4/20\n","938/938 [==============================] - 5s 5ms/step - loss: 0.1953 - accuracy: 0.9277\n","Epoch 5/20\n","938/938 [==============================] - 4s 4ms/step - loss: 0.1702 - accuracy: 0.9360\n","Epoch 6/20\n","938/938 [==============================] - 4s 5ms/step - loss: 0.1496 - accuracy: 0.9435\n","Epoch 7/20\n","938/938 [==============================] - 5s 5ms/step - loss: 0.1283 - accuracy: 0.9520\n","Epoch 8/20\n","938/938 [==============================] - 4s 4ms/step - loss: 0.1091 - accuracy: 0.9593\n","Epoch 9/20\n","938/938 [==============================] - 4s 4ms/step - loss: 0.0938 - accuracy: 0.9647\n","Epoch 10/20\n","938/938 [==============================] - 4s 5ms/step - loss: 0.0810 - accuracy: 0.9694\n","Epoch 11/20\n","938/938 [==============================] - 4s 4ms/step - loss: 0.0664 - accuracy: 0.9750\n","Epoch 12/20\n","938/938 [==============================] - 4s 4ms/step - loss: 0.0618 - accuracy: 0.9768\n","Epoch 13/20\n","938/938 [==============================] - 5s 5ms/step - loss: 0.0516 - accuracy: 0.9807\n","Epoch 14/20\n","938/938 [==============================] - 4s 4ms/step - loss: 0.0470 - accuracy: 0.9818\n","Epoch 15/20\n","938/938 [==============================] - 4s 4ms/step - loss: 0.0407 - accuracy: 0.9849\n","Epoch 16/20\n","938/938 [==============================] - 5s 5ms/step - loss: 0.0403 - accuracy: 0.9850\n","Epoch 17/20\n","938/938 [==============================] - 4s 4ms/step - loss: 0.0325 - accuracy: 0.9879\n","Epoch 18/20\n","938/938 [==============================] - 4s 4ms/step - loss: 0.0370 - accuracy: 0.9863\n","Epoch 19/20\n","938/938 [==============================] - 5s 5ms/step - loss: 0.0296 - accuracy: 0.9889\n","Epoch 20/20\n","938/938 [==============================] - 4s 4ms/step - loss: 0.0285 - accuracy: 0.9898\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"WEVvwkdcNKBp"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"toc_visible":true,"provenance":[{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1681457502882}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"accelerator":"GPU","gpuClass":"standard"},"nbformat":4,"nbformat_minor":0}